import{r as i,X as T,o as d,b as l,w as t,e as B,c as b,ag as x,f as S,Y as $,Z as D,_ as U,$ as F,h as R,g as z,p as M,m as L,a0 as I,q as g,a2 as O,a3 as W,a4 as X,a5 as Y,i as q,a7 as Z,a8 as j,a9 as G,aa as H,W as J}from"./index-Dq5YoMTe.js";/* empty css                        *//* empty css                 */import"./el-tooltip-l0sNRNKZ.js";/* empty css                     */import{P as K}from"./pageContainer-BnKbueKC.js";/* empty css                  *//* empty css                   *//* empty css                     */import{i as C}from"./request-CjAdyTqz.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Q=(s,v,_)=>C.get("/products-get",{params:{pagesNumber:s,pagesSize:v,productType:_}}),ee=s=>C.post("/products-add",s),le=s=>C.delete("/products-delete",{params:{id:s}}),oe=s=>C.put("/products-update",s),ae={class:"channelAdd"},te={class:"dialog-footer"},ne={__name:"ChannelVipAdd",emits:["success"],setup(s,{expose:v,emit:_}){const f=i(null),m=i(!1),o=i({_id:"",productType:"",productName:"",en_name:"",price:"",goldCoinsAmount:"",membershipType:"",dailyDownloadLimit:"",description:"",en_description:""}),h=i([{label:"金币充值",value:"gold"},{label:"购买会员",value:"membership"}]),w=i([{label:"年费会员",value:"annual"},{label:"永久会员",value:"permanent"}]),k=i({productType:[{required:!0,message:"请选择商品类型",trigger:"change"}],productName:[{required:!0,message:"请输入商品名称",trigger:"blur"}],price:[{required:!0,message:"请输入商品价格",trigger:"blur"}],description:[{required:!0,message:"请输入商品描述",trigger:"blur"}]}),E=_,c=async()=>{try{await f.value.validate(),o.value._id?(await oe(o.value),g.success("更新成功")):(await ee(o.value),g.success("添加成功")),m.value=!1,E("success")}catch(n){console.error("提交失败:",n),g.error(n.message||"提交失败")}};return v({open:(n={})=>{m.value=!0,o.value={_id:n._id||"",productType:n.productType||"",productName:n.productName||"",en_name:n.en_name||"",price:n.price||"",goldCoinsAmount:n.goldCoinsAmount||"",membershipType:n.membershipType||"",dailyDownloadLimit:n.dailyDownloadLimit||"",description:n.description||"",en_description:n.en_description||""}}}),(n,e)=>{const y=F,V=$,u=S,p=R,N=B,A=M,P=I;return d(),T("div",ae,[l(P,{modelValue:m.value,"onUpdate:modelValue":e[10]||(e[10]=a=>m.value=a),title:o.value._id?"编辑用户":"添加用户",width:"30%"},{footer:t(()=>[z("span",te,[l(A,{onClick:e[9]||(e[9]=a=>m.value=!1)},{default:t(()=>e[11]||(e[11]=[L("取消")])),_:1}),l(A,{type:"primary",onClick:c},{default:t(()=>e[12]||(e[12]=[L(" 确认 ")])),_:1})])]),default:t(()=>[l(N,{ref_key:"formRef",ref:f,model:o.value,rules:k.value,"label-width":"100px",style:{"padding-right":"30px"}},{default:t(()=>[l(u,{label:"商品类型",prop:"productType",required:""},{default:t(()=>[l(V,{modelValue:o.value.productType,"onUpdate:modelValue":e[0]||(e[0]=a=>o.value.productType=a),placeholder:"请选择商品的类型",style:{width:"240px"}},{default:t(()=>[(d(!0),T(D,null,U(h.value,a=>(d(),b(y,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"商品名称",prop:"productName",required:""},{default:t(()=>[l(p,{modelValue:o.value.productName,"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.productName=a)},null,8,["modelValue"])]),_:1}),l(u,{label:"英文名称",prop:"en_name"},{default:t(()=>[l(p,{modelValue:o.value.en_name,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.en_name=a)},null,8,["modelValue"])]),_:1}),l(u,{label:"商品价格",prop:"price",required:""},{default:t(()=>[l(p,{modelValue:o.value.price,"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.price=a),modelModifiers:{number:!0},type:"number"},null,8,["modelValue"])]),_:1}),o.value.productType==="gold"?(d(),b(u,{key:0,label:"金币数量",prop:"goldCoinsAmount"},{default:t(()=>[l(p,{modelValue:o.value.goldCoinsAmount,"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.goldCoinsAmount=a),modelModifiers:{number:!0},type:"number"},null,8,["modelValue"])]),_:1})):x("",!0),o.value.productType==="membership"?(d(),b(u,{key:1,label:"会员类型",prop:"membershipType"},{default:t(()=>[l(V,{modelValue:o.value.membershipType,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.membershipType=a),placeholder:"请选择会员的类型",style:{width:"240px"}},{default:t(()=>[(d(!0),T(D,null,U(w.value,a=>(d(),b(y,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):x("",!0),o.value.productType==="membership"?(d(),b(u,{key:2,label:"下载额度",prop:"dailyDownloadLimit"},{default:t(()=>[l(p,{modelValue:o.value.dailyDownloadLimit,"onUpdate:modelValue":e[6]||(e[6]=a=>o.value.dailyDownloadLimit=a),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1})):x("",!0),l(u,{label:"商品描述",prop:"description",required:""},{default:t(()=>[l(p,{modelValue:o.value.description,"onUpdate:modelValue":e[7]||(e[7]=a=>o.value.description=a),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1}),l(u,{label:"英文描述",prop:"en_description"},{default:t(()=>[l(p,{modelValue:o.value.en_description,"onUpdate:modelValue":e[8]||(e[8]=a=>o.value.en_description=a),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}},fe={__name:"VipPro",setup(s){const v=i(!1),_=i(!1),f=i({pagesNumber:1,pagesSize:10}),m=i([]),o=async()=>{const c=await Q(f.value.pagesNumber,f.value.pagesSize);m.value=c.data,m.value.forEach(r=>{r.productType==="gold"&&(r.productType="金币充值"),r.productType==="membership"&&(r.productType="购买会员"),r.membershipType==="annual"&&(r.membershipType="年费会员"),r.membershipType==="permanent"&&(r.membershipType="永久会员")})},h=()=>{_.value.open({})},w=c=>{_.value.open(c)},k=async c=>{J.confirm("确定要删除此产品吗?").then(async()=>{const r=await le(c._id);console.log(r),r.code===200?(await o(),g.success("删除成功")):g.error("删除失败")}).catch(r=>{console.log("删除出错",r)})},E=()=>{o()};return O(()=>{o()}),(c,r)=>{const n=M,e=Y,y=G,V=X,u=H;return d(),T(D,null,[l(K,{title:"商品管理"},{extra:t(()=>[l(n,{type:"primary",onClick:h},{default:t(()=>r[0]||(r[0]=[L("添加商品")])),_:1})]),default:t(()=>[W((d(),b(V,{data:m.value,style:{width:"100%"}},{empty:t(()=>[l(y,{description:"没有数据"})]),default:t(()=>[l(e,{label:"序号",sortable:"",align:"center",width:"100",type:"index"}),l(e,{label:"商品类型",align:"center",prop:"productType"}),l(e,{label:"商品名称",align:"center",prop:"productName"}),l(e,{label:"英文名称",align:"center",prop:"en_name","show-overflow-tooltip":""}),l(e,{label:"商品价格",sortable:"",align:"center",prop:"price"}),l(e,{label:"金币数量",sortable:"",align:"center",prop:"goldCoinsAmount"}),l(e,{label:"会员类型",sortable:"",align:"center",prop:"membershipType"}),l(e,{label:"下载额度",align:"center",prop:"dailyDownloadLimit"}),l(e,{label:"商品描述",align:"center",prop:"description",width:"300","show-overflow-tooltip":""}),l(e,{label:"商品描述",align:"center",prop:"en_description",width:"300","show-overflow-tooltip":""}),l(e,{label:"操作",align:"right",width:"100"},{default:t(({row:p})=>[l(n,{icon:q(Z),circle:"",plain:"",type:"primary",onClick:N=>w(p)},null,8,["icon","onClick"]),l(n,{icon:q(j),circle:"",plain:"",type:"danger",onClick:N=>k(p)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])),[[u,v.value]])]),_:1}),l(ne,{ref_key:"dialog",ref:_,onSuccess:E},null,512)],64)}}};export{fe as default};
